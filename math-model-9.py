# import pandas as pd (для построения таблицы)
import numpy as np  # используется для работы с матрицами 
# pip install numpy
a, b = 4, 2
n = 76
y = [47, 47, 48, 49, 49, 50, 50, 51, 51, 52, 53, 55, 56, 57, 57, 57, 57, 58, 58, 59, 60, 62, 63, 64, 64, 65, 66, 66, 66, 67, 67, 67, 67, 68, 68, 69, 69, 69, 69, 70, 70, 70, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 
     73, 73, 73, 74, 75, 76, 76, 76, 77, 77, 77, 77, 77, 77, 77, 78, 78, 78, 78, 78, 78, 79, 79, 80]
x1 = [3.0, 4.9, 2.6, 2.3, 2.9, 2.0, 6.5, 5.7, 7.6, 2.4, 4.5, 4.3, 4.2, 3.4, 7.5, 7.8, 9.0, 5.1, 5.1, 7.4, 8.3, 5.2, 14.2, 14.1, 18.6, 12.4, 10.6, 12.4, 14.0, 7.0, 9.7, 20.0, 20.7, 7.4, 13.5, 10.8, 15.6, 18.5, 
      28.0, 15.6, 19.6, 20.0, 14.3, 29.3, 33.4, 49.0, 12.1, 13.4, 23.7, 31.9, 35.3, 42.4, 22.2, 24.6, 30.8, 13.1, 78.7, 60.6, 65.8, 84.4, 53.8, 58.1, 61.1, 70.2, 78.8, 80.3, 100.0, 43.4, 70.0, 73.7, 73.9, 
      78.3, 95.9, 68.7, 85.1, 82.0]
x2 = [2.6, 3.1, 2.5, 2.6, 2.8, 2.9, 2.9, 2.5, 2.9, 3.1, 2.9, 2.5, 3.0, 2.0, 2.4, 2.9, 2.3, 1.6, 2.7, 2.8, 2.9, 1.8, 2.0, 1.6, 2.2, 2.0, 2.2, 2.9, 2.0, 3.0, 2.2, 1.5, 1.7, 3.1, 2.7, 1.1, 2.2, 1.9, 0.9, 0.2, 2.2, 
      0.3, 1.9, 2.3, 2.4, 1.3, 1.3, 0.3, 1.9, 0.8, 1.5, 0.9, 1.7, 0.6, 1.3, 1.0, 0.3, 1.4, 0.5, 2.0, 0.2, 0.5, 3.5, 1.1, 0.8, 0.4, 1.0, 0.6, 0.5, 0.2, 0.7, 1.3, 1.0, 0.6, 1.6, 0.3]
x3 = [2.4, 2.8, 2.5, 2.7, 2.1, 2.7, 2.5, 2.7, 2.6, 3.1, 2.8, 2.4, 2.8, 1.7, 2.2, 3.1, 2.3, 2.1, 2.7, 2.7, 3.3, 2.0, 2.7, 2.5, 2.4, 2.6, 2.7, 3.5, 3.1, 3.8, 3.4, 1.6, 2.1, 4.0, 2.9, 1.1, 3.2, 3.0, 1.3, 0.2, 4.1, 
      0.6, 2.6, 3.0, 2.7, 1.8, 2.0, 0.7, 2.8, 1.8, 2.1, 1.9, 2.4, 1.0, 2.0, 1.8, 0.1, 1.5, 0.1, 1.7, 1.0, 1.7, 3.5, 1.4, 0.5, 0.5, 1.1, 0.9, 0.8, 0.4, 0.6, 1.0, 0.8, 0.3, 1.3, 0.6]
x4 = [113, 124, 117, 98, 99, 123, 95, 96, 90, 89, 80, 91, 88, 72, 55, 56, 64, 79, 58, 73, 90, 68, 56, 51, 50, 55, 39, 44, 47, 45, 36, 44, 48, 46, 41, 34, 36, 39, 35, 13, 34, 14, 37, 23, 12, 16, 16, 11, 33, 13, 12, 
      10, 23, 18, 22, 13, 6, 7, 5, 4, 7, 6, 8, 6, 6, 8, 8, 8, 6, 7, 6, 6, 6, 4, 5, 4]
for i in range(n):
    y[i] = y[i] + a
    x4[i] = x4[i] + b

# оценить коэффициенты линейной регрессионной модели (y = b0 + b1*x1 + b2*x2 + b3*x3 + b4*x4)
x_1 = [1] * n
matrix_x = np.array([x_1, x1, x2, x3, x4])
matrix_y = np.array([y])
matrix_xT = matrix_x.transpose()
matrix_yT = matrix_y.transpose()
matrix_x_mult_xT = np.dot(matrix_x, matrix_xT)
matrix_x_mult_yT = np.dot(matrix_x, matrix_yT)
inverse_matrix_x_mult_xT = np.linalg.inv(matrix_x_mult_xT)
matrix_coeff = np.dot(inverse_matrix_x_mult_xT, matrix_x_mult_yT)
print('а) Оценить коэффициенты линейной регрессионной модели')
print('y = ' + str(round(matrix_coeff[0, 0], 3)) + ' + ' + str(round(matrix_coeff[1, 0], 3)) + '*x1 + ' + str(round(matrix_coeff[2, 0], 3)) + '*x2 + ' + str(round(matrix_coeff[3, 0], 3)) + 
      '*x3 + ' + str(round(matrix_coeff[4, 0], 3)) + '*x4')